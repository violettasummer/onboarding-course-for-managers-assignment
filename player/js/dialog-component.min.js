(self.webpackChunk=self.webpackChunk||[]).push([[6008],{99493:(e,t)=>{"use strict";t.DIALOG_ITEM_DISPLAYED="DIALOG_ITEM_DISPLAYED",t.DIALOG_INCREMENT_INDEX="DIALOG_INCREMENT_INDEX",t.DIALOG_SHOW_DIALOG="DIALOG_SHOW_DIALOG",t.dialogItemDisplayed=(e,i)=>({type:t.DIALOG_ITEM_DISPLAYED,payload:{componentId:e,itemId:i}}),t.dialogShowDialog=e=>({type:t.DIALOG_SHOW_DIALOG,payload:{componentId:e}}),t.dialogIncrementIndex=(e,i)=>({type:t.DIALOG_INCREMENT_INDEX,payload:{componentId:e,currentItemIndex:i}})},73125:(e,t,i)=>{"use strict";const s=i(90882),o=i(54073),n=i(55281),r=i(16760),a=i(80537),l=i(58335),d=i(13980),c=i(2784),{Component:p}=i(58720),m=i(96235),h=i(70913),u=i(23346),_=i(73822),g=i(20198),I=l({displayName:"Dialog",propTypes:{component:d.object.isRequired,setComponentAsReady:d.func.isRequired,setComponentAsViewed:d.func.isRequired,setComponentAsStarted:d.func.isRequired,setComponentAsComplete:d.func.isRequired,dialogItemDisplayed:d.func.isRequired,dialogIncrementIndex:d.func.isRequired,dialogShowDialog:d.func.isRequired,isLivePreview:d.bool.isRequired,isPageReady:d.bool,screenSize:d.string.isRequired,theme:d.object,styles:d.object},getInitialState:()=>({_canScrollOnEnter:!0}),componentDidMount(){this.props.setComponentAsReady(this.props.component._id)},UNSAFE_componentWillReceiveProps({component:e}){e._isComplete||s(e._items,(e=>e._hasDisplayed)).length===e._items.length&&this.props.setComponentAsComplete(e._id)},componentWillUnmount(){this.removeScrollEventListener()},addScrollEventListener(){this._scrollYPosition=window.scrollY,window.addEventListener("scroll",this.onWindowScroll)},removeScrollEventListener(){window.removeEventListener("scroll",this.onWindowScroll)},setDialogItemAsDisplayed(e){this.props.dialogItemDisplayed(this.props.component._id,e._id)},startDialog(){const{props:e}=this;e.component._hasStarted||e.setComponentAsStarted(e.component._id),e.dialogShowDialog(e.component._id)},startDialogInView(){const{component:e}=this.props,t=e._inviewStartDelay||0;this.addScrollEventListener(),this._startTimer=setTimeout((()=>{this.startDialog()}),t)},onWindowScroll:o((function(){const e=window.scrollY;if(e<this._scrollYPosition)return this.removeScrollEventListener(),void this.setState({_canScrollOnEnter:!1});this._scrollYPosition=e}),100),onVisibilityChanged(e,{top:t,bottom:i}){const{props:s}=this;t&&(this.isInviewTop=!0),i&&(this.isInviewBottom=!0),this.isInviewTop&&this.isInviewBottom&&(s.component._hasBeenViewed||s.setComponentAsViewed(s.component._id),s.component._isStartDialogInView&&this.startDialogInView())},onNextItem(){const{component:e,dialogIncrementIndex:t}=this.props,i=this.getNextItemIndex(e.currentItemIndex);i?t(e._id,i):this.removeScrollEventListener()},onStartClicked(){this.addScrollEventListener(),this.startDialog()},getIsVisibilitySensorActive(){const{component:e,isPageReady:t,isLivePreview:i}=this.props;return!!i||!0===t&&!0===e._isReady&&(!0===e._isStartDialogInView&&void 0===this._startTimer||!e._hasBeenViewed)},getItemPerson(e){const{component:t}=this.props;return n(t._people,{_id:e._personId})},getNextItemIndex(e){const{component:t}=this.props,i=t._items,s=e+1;if(s===i.length)return;const o=i[s];return this.getItemPerson(o)?s:(this.setDialogItemAsDisplayed(o),this.getNextItemIndex(s))},getStyle(){const{props:e}=this,t={},{screenSize:i}=e,s="small"===i?"_mobileBackgroundImage":"_backgroundImage",o=e.component[s];return o&&o.src&&(t.backgroundImage=`url(${h(o.src)})`,t.backgroundPosition=o._position,t.backgroundSize=o._size,t.backgroundRepeat="no-repeat"),t},renderDialogStart(){const{component:e,theme:t}=this.props;if(!e.showDialog)return c.createElement(_,{component:e,onStartClicked:this.onStartClicked,people:e._people,dialogStartButtonText:e.dialogStartButtonText,swatches:t._swatches})},renderItems(){const{component:e,theme:t}=this.props;if(!e.showDialog)return;const i=this.state._canScrollOnEnter&&!e._shouldDisableProgessionAnimation,s=r(e._items,((s,o)=>{const n=this.getItemPerson(s);if(!n)return null;const r=e._useNextButton||!e._isStartDialogInView&&0===o;return c.createElement(g,{key:s._id,person:n,item:s,isCurrentItem:o===e.currentItemIndex,useNextButton:!e._isStartDialogInView&&e._useNextButton,onNextItem:this.onNextItem,dialogItemAvatarWidth:e._dialogItemAvatarWidth,shouldShowPersonNameOnItem:e._shouldShowPersonNameOnItem,canScrollOnEnter:i,canFocusOnEnter:r,onItemDisplayed:this.setDialogItemAsDisplayed,animations:e._animations,swatches:t._swatches})})),o={};return a(e._dialogItemsContainerWidth)&&(o.width=`${e._dialogItemsContainerWidth}%`),c.createElement("ul",{className:"ev-dialog-items",style:o},s)},renderNextButton(){const{component:e}=this.props;if(!e._isStartDialogInView&&e.showDialog&&e._useNextButton&&e.currentItemIndex!==e._items.length-1)return c.createElement("div",{className:"ev-dialog-next-button-container",style:{textAlign:e._nextButtonAlignment}},c.createElement(u,{text:e.nextButtonText,icon:e._nextButtonIcon,iconSize:e._nextButtonIconSize,iconPosition:e._nextButtonIconPosition,showPulseAnimation:e._nextButtonShowPulseAnimation&&0===e.currentItemIndex,"aria-label":e.nextButtonAriaLabel,onClick:this.onNextItem}))},render(){return c.createElement(p,{component:this.props.component,styles:this.props.styles,isVisibilitySensorActive:this.getIsVisibilitySensorActive(),onVisibilityChange:this.onVisibilityChanged},c.createElement("div",{className:m(this.props.component),style:this.getStyle()},this.renderDialogStart(),this.renderItems(),this.renderNextButton()))}});e.exports=I},20198:(e,t,i)=>{"use strict";var s=i(39322);const o=i(80537),n=i(82421),r=i(72579),a=i(58335),l=i(32823),d=i(13980),c=i(2784),p=i(28316),m=i(72779),h=i(56249),u=i(88078),_=i(60309),g=i(11865),I=a({displayName:"DialogItem",propTypes:{person:d.object.isRequired,item:d.object.isRequired,onNextItem:d.func.isRequired,canScrollOnEnter:d.bool.isRequired,canFocusOnEnter:d.bool.isRequired,onItemDisplayed:d.func.isRequired,animations:d.object,useNextButton:d.bool.isRequired,isCurrentItem:d.bool,dialogItemAvatarWidth:d.string,swatches:d.object,shouldShowPersonNameOnItem:d.bool},mixins:[l],getDefaultProps:()=>({useNextButton:!1}),componentDidMount(){this.props.isCurrentItem&&this.displayItem()},UNSAFE_componentWillReceiveProps(e){this.props.item._isVisible||!e.isCurrentItem||this._hasStartedToDisplay||this.displayItem()},componentDidUpdate(e){if(!e.item._isVisible&&this.props.item._isVisible){const e=p.findDOMNode(this);e&&(this.scrollToItem(e),this.props.canFocusOnEnter&&e.focus({preventScroll:!0}))}},displayItem(){this._hasStartedToDisplay=!0,this.props.useNextButton||setTimeout((()=>{this.props.onNextItem()}),this.props.item._delay),this.props.onItemDisplayed(this.props.item)},scrollToItem(e){if(!this.props.canScrollOnEnter)return;const t=s(e),i=s(window),o=i.scrollTop();if(t.offset().top+t.height()>o+i.height()){const t=o+e.offsetHeight+100;s("html, body").animate({scrollTop:t},1e3)}},getItemInnerStyle(){const{person:e}=this.props,t=this.props.item._dialogItemWidth,i=_(e._dialogBackgroundColor,this.props.swatches),s={};return i&&"transparent"!==i&&(s.backgroundColor=i),o(t)&&(s.width=`${t}%`),s},getTextStyle(){const{person:e}=this.props,t=_(e._dialogTextColor,this.props.swatches),i={};return t&&"transparent"!==t&&(i.color=t),i},getAnimations(){const{item:e,animations:t}=this.props;let i=n({},t);if(t||(i={_slideInX:{_isEnabled:!0,_from:100},_fadeIn:{_isEnabled:!0,_from:0},_easing:"slow"}),i._slideInX._isEnabled){const t=e._isOnRightSide,s=i._slideInX._from;return n({},i,{_slideInX:n({},i._slideInX,{_from:t?s:-s})})}return i},renderPersonName(){if(this.props.shouldShowPersonNameOnItem)return c.createElement("div",{className:"ev-dialog-item-name","aria-hidden":!0,style:this.getTextStyle()},this.props.person.name)},render(){const e=this.getAnimations(),t=r(e,"_fadeIn._isEnabled",!1),i=r(e,"_scaleIn._isEnabled",!1);return this.props.item._isVisible||t||i?this.props.useNextButton&&!this.props.item._isVisible?null:c.createElement(h,{className:m("ev-dialog-item",{"ev-dialog-item-right-item":this.props.item._isOnRightSide,"ev-dialog-item-current-item":this.props.isCurrentItem}),tag:"li",animations:e,startAnimation:this.props.item._isVisible,tabIndex:this.props.isCurrentItem?"-1":null},c.createElement("div",{className:"ev-dialog-item-inner",style:this.getItemInnerStyle()},c.createElement("div",{className:"ev-dialog-item-avatar"},c.createElement(u,{graphicSrc:this.props.person.avatar,altText:this.props.person.name,style:{width:this.props.dialogItemAvatarWidth}}),this.renderPersonName()),c.createElement(g,{className:"ev-dialog-item-message",style:this.getTextStyle(),body:this.props.item.body}))):null}});e.exports=I},73822:(e,t,i)=>{"use strict";const s=i(16760),o=i(58335),n=i(13980),r=i(2784),{Motion:a,spring:l}=i(96001),d=i(60309),c=i(23346),p=i(88078),m=o({displayName:"DialogStart",getInitialState:()=>({_y:0,_opacity:1}),propTypes:{component:n.object.isRequired,onStartClicked:n.func.isRequired,people:n.array.isRequired,dialogStartButtonText:n.string.isRequired,swatches:n.object},getStyle:e=>({transform:`translate3d(0, ${e.y}%, 0)`,opacity:e.opacity}),getAvatarImgStyle(){return{width:this.props.component._dialogStartAvatarWidth}},getAvatarStyle(e){const t=d(e._dialogBackgroundColor,this.props.swatches),i={};return t&&"transparent"!==t&&(i.backgroundColor=t),i},getTextStyle(e){const t=d(e._dialogTextColor,this.props.swatches),i={};return t&&"transparent"!==t&&(i.color=t),i},onStartClicked(){this.setState({_y:-20,_opacity:0,_startClicked:!0}),setTimeout((()=>{this.props.onStartClicked()}),300)},renderStartButton(){if(!this.state._startClicked&&!this.props.component._isStartDialogInView)return r.createElement(c,{className:"ev-dialog-start-button",text:this.props.dialogStartButtonText,onClick:this.onStartClicked})},renderContent(e){return r.createElement("div",{className:"ev-dialog-start-avatars",style:this.getStyle(e)},s(this.props.people,(e=>r.createElement("div",{className:"ev-dialog-start-avatar",key:e._id,style:this.getAvatarStyle(e)},r.createElement(p,{graphicSrc:e.avatar,altText:e.name,style:this.getAvatarImgStyle()}),r.createElement("div",{className:"ev-dialog-start-name","aria-hidden":!0,style:this.getTextStyle(e)},e.name)))))},render(){return r.createElement("div",{className:"ev-dialog-start"},r.createElement(a,{defaultStyle:{y:0,opacity:1},style:{y:l(this.state._y),opacity:l(this.state._opacity)}},this.renderContent),r.createElement("div",{className:"ev-dialog-start-action"},this.renderStartButton()))}});e.exports=m},7159:(e,t,i)=>{"use strict";const{registerComponent:s}=i(90876),o=i(73125),{dialogItemDisplayed:n,dialogIncrementIndex:r,dialogShowDialog:a}=i(99493);s("dialog",{component:o,actions:{dialogItemDisplayed:n,dialogIncrementIndex:r,dialogShowDialog:a},reducer:i(74146),trackingMap:i(82179),mapStateToProps:({app:e})=>({isLivePreview:e.isLivePreview})})},74146:(e,t,i)=>{"use strict";const s=i(12982),o=i(60019),n=i(16760),{SETUP_COMPONENT:r}=i(29933),{DIALOG_ITEM_DISPLAYED:a,DIALOG_INCREMENT_INDEX:l,DIALOG_SHOW_DIALOG:d}=i(99493);e.exports=(e,t)=>{switch(t.type){case r:return o({},e,{showDialog:!1,currentItemIndex:0,_items:n(e._items,(e=>o({},e,{_isVisible:!1})))});case d:return o({},e,{showDialog:!0});case a:return function(e,t){const{itemId:i}=e.payload,n=s(t._items,(e=>e._id===i)),r=o({},t._items[n],{_hasDisplayed:!0,_isVisible:!0}),a=[...t._items.slice(0,n),r,...t._items.slice(n+1)];return o({},t,{_items:a})}(t,e);case l:return o({},e,{currentItemIndex:t.payload.currentItemIndex});default:return e}}},82179:e=>{"use strict";e.exports={_interactionType:{type:"String",default:"interaction",shouldRestore:!1},_items:{fieldKey:"_items",type:"Array",shouldRestore:!0,subMap:{_id:{fieldKey:"_id",type:"String"},_hasDisplayed:{fieldKey:"_hasDisplayed",type:"Boolean",shouldRestore:!0}}}}},96235:(e,t,i)=>{"use strict";const s=i(72779);e.exports=e=>s(`ev-${e._component}-widget ev-component-widget ev-clearfix`,{"ev-disabled":!e._isEnabled,"ev-complete ev-show-user-answer":e._isComplete&&!e._isEnabled,"ev-correct":e._isCorrect&&!e._isEnabled,"ev-submitted":e._isSubmitted})},80537:(e,t,i)=>{var s=i(53366),o=i(15125);e.exports=function(e){return"number"==typeof e||o(e)&&"[object Number]"==s(e)}}}]);