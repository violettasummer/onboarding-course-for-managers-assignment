"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4613],{99901:(e,t)=>{t.REFLECTION_COMPLETED="REFLECTION_COMPLETED",t.reflectionCompleted=e=>({type:t.REFLECTION_COMPLETED,payload:e})},41547:(e,t,n)=>{var o=n(14859)(n(52954));const r=n(58335),s=n(13980),i=n(2784),l=n(81197),c=n(38105),a=r({displayName:"ReflectionDownload",propTypes:{reflection:s.object.isRequired,username:s.string.isRequired,course:s.object.isRequired,components:s.array.isRequired,isComplete:s.bool.isRequired,downloads:s.object,device:s.object.isRequired},onDownloadReflectionClicked(e){var t=this;return(0,o.default)((function*(){e.preventDefault(),e.currentTarget.blur();const{reflection:n,course:o,components:r,username:s}=t.props;if(n._isHtmlFormat)return void c(n,o,r,s);const i=yield l(n,o,r,s);if(t.props.device.touch&&!t.props.device.isWindowsTouchScreen)return i.open();const a=(null==n?void 0:n.fileName)||"Reflection";i.download(`${a}.pdf`)}))()},isLearnerNameRequired(){const{reflection:e,username:t}=this.props;return!e._shouldNotShowLearnerName&&!t},renderDownloadButton(){const e=!this.props.isComplete||this.isLearnerNameRequired();return i.createElement("button",{className:"ev-button ev-reflection-download",onClick:this.onDownloadReflectionClicked,disabled:e},this.props.reflection.downloadButtonText)},renderReflectionItemText(){const{reflection:e,isComplete:t}=this.props,n=t?e.downloadAvailableText:e.downloadNotAvailableText;return i.createElement("div",null,n)},renderNameRequiredText(){if(this.props.isComplete&&this.isLearnerNameRequired())return i.createElement("span",{className:"ev-reflection-action-warning ev-label"},i.createElement("strong",null,this.props.downloads.nameRequiredText))},render(){return i.createElement("div",{className:"ev-list-item ev-reflection-download"},i.createElement("div",{className:"ev-list-item-inner ev-clearfix"},i.createElement("div",{className:"ev-list-item-left"},i.createElement("div",{className:"ev-list-item-title"},this.props.reflection.title),i.createElement("div",{className:"ev-list-item-content"},this.renderReflectionItemText())),i.createElement("div",{className:"ev-list-item-right"},this.renderNameRequiredText(),this.renderDownloadButton())))}});e.exports=a},61887:(e,t,n)=>{var o=n(14859)(n(58527));const{connect:r}=n(57903),s=n(2784),{reflectionComponentsSelector:i}=n(51360),l=n(41547);e.exports=r((e=>({course:e.course,device:e.device,isComplete:e.reflection.isComplete,components:i(e)})))((e=>s.createElement(l,(0,o.default)({},e,{reflection:e.course._reflection}))))},398:(e,t,n)=>{const o=n(2784),{Redirect:r}=n(77682),{Observable:s}=n(28761),i=n(67718),{SETUP_APP:l,APP_STARTED:c}=n(63444),{addElement:a}=n(51777),{COMPONENT_COMPLETED:d,COMPONENTS_UPDATED:p}=n(29933),{addPrompt:m}=n(90672),{loadPdfMake:E}=n(13066),{COURSE_ATTAINMENT_COMPONENT_COMPLETED:u,COURSE_ATTAINMENT_ACHIEVEMENTS_UPDATED:_}=n(66455),{COURSE_ASSESSMENT_COMPLETE:f}=n(36580),S=n(61887),{reflectionCompleted:C}=n(99901),T=n(193),N=n(7389),O=n(96597),h=n(42252);function A({course:e}){const t=[C(!0)];if(!e._reflection._hideDialog){const n={title:e._reflection.title,body:e._reflection.downloadAvailableText,_action:{text:e._downloads.viewDownloadsButtonText,_link:{_link:"downloads",_linkType:"extensions"}},_glyph:{_type:"icon",_icon:"license"}};t.push(m(n))}return s.of(...t)}t.registerElementsEpic=(e,t)=>e.filter(i(l,"_reflection",t)).mergeMap((()=>{const e=t.getState(),n=[E(),a({props:{},component:S,parent:"downloads",name:"reflection"}),a({parent:"router",name:"reflectionRedirect",path:"/reflection",exact:!0,render:()=>o.createElement(r,{to:"/downloads"})})];return T(e)&&n.push(C(!0)),s.of(...n)})),t.checkOnAppReadyOrComponentsUpdatedEpic=(e,t)=>e.filter(i([c,p],"_reflection",t)).mergeMap((()=>{const e=t.getState();return e.reflection.isComplete&&!T(e)?s.of(C(!1)):s.empty()})),t.checkOnCourseAttainmentMethod=(e,t)=>e.filter((({type:e})=>{if(e!==_&&e!==u)return!1;const n=t.getState();return!n.reflection.isComplete&&O(n)})).mergeMap((()=>A(t.getState()))),t.checkOnCourseAssessmentMethod=(e,t)=>e.filter((({type:e})=>{if(e!==f)return!1;const n=t.getState();return!n.reflection.isComplete&&N(n)})).mergeMap((()=>A(t.getState()))),t.checkOnOpenInputComponentsCompleted=(e,t)=>e.filter((({type:e})=>{if(e!==d)return!1;const n=t.getState();return!n.reflection.isComplete&&h(n)})).mergeMap((()=>A(t.getState())))},193:(e,t,n)=>{const o=n(23531),r=n(7389),s=n(96597),i=n(42252);e.exports=e=>{let t=!1;switch(e.course._reflection._obtainmentMethod){case o.COURSE_ASSESSMENT:case o.COURSE_ASSESSMENT_PASSED:t=r(e);break;case o.COURSE_ATTAINMENT:t=s(e);break;case o.OPEN_INPUTS:t=i(e);break;case o.NONE:t=!0}return t}},7389:(e,t,n)=>{const o=n(72579),{COURSE_ASSESSMENT:r,COURSE_ASSESSMENT_PASSED:s}=n(23531);e.exports=({course:e,courseAssessment:t={}})=>!(!o(e,"_reflection._isEnabled")||!o(e,"_courseAssessment._isEnabled")||e._reflection._obtainmentMethod!==r&&e._reflection._obtainmentMethod!==s||!t._isComplete||e._reflection._obtainmentMethod===s&&!t._isPassed)},96597:(e,t,n)=>{const o=n(72579),{COURSE_ATTAINMENT:r}=n(23531);e.exports=({course:e,courseAttainment:t={}})=>!!(o(e,"_reflection._isEnabled")&&o(e,"_courseAttainment._isEnabled")&&e._reflection._obtainmentMethod===r&&t._isComplete)},42252:(e,t,n)=>{const o=n(90882),{OPEN_INPUTS:r}=n(23531);e.exports=({course:e,components:t})=>{const{_isEnabled:n,_obtainmentMethod:s}=e._reflection;if(!n||s!==r)return!1;const i=["openInput","linkedOpenInput"],l=o(t,(({_component:e})=>i.includes(e)));return!!l.length&&o(l,"_isComplete").length===l.length}},23531:e=>{e.exports={COURSE_ASSESSMENT:"Course Assessment",COURSE_ASSESSMENT_PASSED:"Course Assessment Passed",COURSE_ATTAINMENT:"Course Attainment",OPEN_INPUTS:"Open Input Components",NONE:"None"}},97689:(e,t,n)=>{const{SETUP_APP:o}=n(63444),{REFLECTION_COMPLETED:r}=n(99901),s={isComplete:!1};e.exports=(e=s,t)=>{if(t.type===o){const n=t.payload.course._reflection;return n&&n._isEnabled?e:s}return t.type===r?{...e,isComplete:t.payload}:e}},59595:(e,t,n)=>{const{registerEpics:o,registerReducer:r}=n(90876),{registerElementsEpic:s,checkOnCourseAttainmentMethod:i,checkOnCourseAssessmentMethod:l,checkOnOpenInputComponentsCompleted:c,checkOnAppReadyOrComponentsUpdatedEpic:a}=n(398);r("reflection",n(97689)),o(s,i,l,c,a)},67718:(e,t,n)=>{const o=n(72579);e.exports=(e,t,n)=>(Array.isArray(e)||(e=[e]),({type:r})=>-1!==e.indexOf(r)&&o(n.getState(),["course",t,"_isEnabled"],!1))}}]);