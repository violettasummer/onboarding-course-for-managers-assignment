"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[799],{19017:e=>{e.exports=function(e){var t;const n=e.displayTitle,i=null!==(t=e._heroImage)&&void 0!==t&&t._isEnabled?e._heroImage.title:null;return n||i}},93976:(e,t,n)=>{const i=n(72579),o=n(16760),s=n(51525),a=n(58335),r=n(13980),l=n(2784),{connect:m}=n(57903),u=n(72779),c=n(34577),{addPrompt:p}=n(44437),{setAriaLive:d}=n(28543),h=n(86587),g=n(57992),v=n(65319),I=n(45390),M=n(14755),f=n(81895),_=n(67963),b=n(10052),y=n(84746),C=n(76434),E=a({displayName:"MapMenu",propTypes:{menu:r.object.isRequired,device:r.object.isRequired,theme:r.object.isRequired,itemIds:r.array.isRequired,course:r.object.isRequired,addPrompt:r.func.isRequired,setAriaLive:r.func.isRequired,hasActionBar:r.bool.isRequired,classList:r.array},getInitialState(){return this.getDefaultState()},getDefaultState:()=>({_isDragging:!1,_isShowingInfo:!1,_selectedItemId:null}),componentDidMount(){const{props:e}=this;e.menu.ariaLabel&&e.setAriaLive({message:e.menu.ariaLabel,delay:200}),this.checkMapMenuImage(),this.checkMapMenuPointerImages()},checkMapMenuImage(){this.props.menu._mapMenu._mapImage||this.showErrorPrompt("No Map Menu image was found!","Make sure you have set a Map Menu image in Evolve")},checkMapMenuPointerImages(){this.getDefaultPointerImage()||s(this.props.itemIds,(e=>{var t;const n=c(e);return!!n&&null===(null===(t=n._mapMenu)||void 0===t?void 0:t._pointerImage)}))&&this.showErrorPrompt("No default Map Menu pointer image was found!","Make sure you have set a default menu pointer image in Evolve")},showErrorPrompt(e,t){this.props.addPrompt({title:e,body:t,_glyph:{_type:"icon",_icon:"cross"}})},getClassName(){const{props:e,state:t}=this;return u("ev-map-menu ev-menu",e.classList,{"ev-is-dragging":t._isDragging,"ev-use-menu-header-styles":e.theme._menu._settings._useMenuHeaderStyles,"ev-disable-inner-flex":e.theme._footer._settings._isStickyFooterDisabled})},getDefaultPointerImage(){const{props:e}=this;return i(e.course,"_mapMenu._defaultPointerImage")},getCloseButtonText(){const{props:e}=this;return i(e.course,"_mapMenu._closeButtonText")},getIsModalOpen(){const{state:e}=this;return!(!e._isShowingInfo&&!e._selectedItemId)},getMenuBody(){const{props:e}=this;return"course"===e.menu._type?e.menu.body:e.menu.description},onPointerClick(e){this.setState({_selectedItemId:e._id,_isShowingInfo:!1})},onInfoClick(){this.setState({_isShowingInfo:!0,_selectedItemId:null})},onInfoCloseClick(){this.setState({_isShowingInfo:!1})},onCloseMenuItemClick(){this.setState({_selectedItemId:null})},renderTitle(){const{menu:e}=this.props;if(e.displayTitle&&e._mapMenu._shouldShowTitleBar)return l.createElement(f,{title:e.displayTitle,body:this.getMenuBody(),infoOpenButtonAriaLabel:e._mapMenu.infoOpenButtonAriaLabel,onInfoClick:this.onInfoClick,isModalOpen:this.getIsModalOpen()})},renderItems(){const{props:e}=this;return o(e.itemIds,(t=>l.createElement(b,{key:t,itemId:t,defaultPointerImage:this.getDefaultPointerImage(),defaultPointerWidth:e.menu._mapMenu._defaultPointerWidth,isModalOpen:this.getIsModalOpen(),onClick:this.onPointerClick})))},renderMapMenuImage(){const e=this.props.menu._mapMenu._mapImage;if(!e)return;const{props:t,state:n}=this;return l.createElement(_,{graphic:e,alt:t.menu._mapMenu.mapImageAltText,menuImageWidth:i(t,"menu._mapMenu._menuImageWidth",1024),menuScrollableContainerMaxWidth:i(t,"menu._mapMenu._menuScrollableContainerMaxWidth",1024),device:t.device,isModalOpen:this.getIsModalOpen(),isDragging:n._isDragging,onDragStart:()=>this.setState({_isDragging:!0}),onDragEnd:()=>this.setState({_isDragging:!1})},this.renderItems())},renderInfo(){if(this.state._isShowingInfo)return l.createElement(y,{body:this.getMenuBody(),closeButtonText:this.getCloseButtonText(),onInfoCloseClick:this.onInfoCloseClick})},getShouldShowProgressBars(){const{props:e}=this,t=i(e.theme,"_menu._settings._shouldShowProgressBarsOnMenus","content"),n=i(e.menu,"_mapMenu._shouldShowProgressBarsOnMenus",!0);return"content"===t?n:"true"===t},renderMenuItem(){var e,t;if(this.state._selectedItemId)return l.createElement(C,{itemId:this.state._selectedItemId,closeButtonText:this.getCloseButtonText(),onCloseMenuItemClick:this.onCloseMenuItemClick,shouldShowProgressBarsOnMenus:this.getShouldShowProgressBars(),durationIcon:null===(e=this.props.theme._menu)||void 0===e||null===(t=e._settings)||void 0===t?void 0:t._durationIcon})},renderActionBar(){if(this.props.hasActionBar)return l.createElement("div",{className:"ev-action-bar-container"},this.renderElements("actionBar"))},renderElements(e){return g("menu",e,{menu:this.props.menu})},render(){const e=v(),t=this.props.menu.displayTitle&&this.props.menu._mapMenu._shouldShowTitleBar?this.context+1:this.context;return l.createElement(I,null,l.createElement("div",{className:this.getClassName()},M(this.props.menu),l.createElement("main",{className:"ev-menu-container ev-map-menu-container",style:{minHeight:`calc(100vh - ${e})`},tabIndex:"-1"},l.createElement("div",{className:"menu-root"},this.renderElements("root")),l.createElement("div",{className:"ev-menu-container-inner ev-map-menu-container-inner"},this.renderTitle(),l.createElement(h.Provider,{value:t},this.renderMapMenuImage(),this.renderActionBar(),this.renderInfo(),this.renderMenuItem())),l.createElement("div",{className:"ev-menu-footer"},this.renderElements("footer")))))}});E.contextType=h,e.exports=m(null,{addPrompt:p,setAriaLive:d})(E)},67963:(e,t,n)=>{var i=n(39322);const o=n(58335),s=n(13980),a=n(2784),r=n(72779),l=n(90212),m=n(88078),u=o({displayName:"MapMenuImage",propTypes:{graphic:s.object.isRequired,device:s.object.isRequired,isModalOpen:s.bool.isRequired,isDragging:s.bool.isRequired,onDragStart:s.func.isRequired,onDragEnd:s.func.isRequired,menuImageWidth:s.number.isRequired,menuScrollableContainerMaxWidth:s.number.isRequired,alt:s.string},getInitialState:()=>({_graphicHeight:null,_graphicWidth:null,_contentHeight:null,_x:0,_y:0}),componentDidMount(){this.setInteract(),this.setContentHeight()},componentDidUpdate({device:e,menuImageWidth:t}){e.windowHeight===this.props.device.windowHeight&&e.orientation===this.props.device.orientation&&t===this.props.menuImageWidth||(this.setImageWidth(),this.setContentHeight())},componentWillUnmount(){l(this._scrollable).unset()},setInteract(){l(this._scrollable).draggable({onmove:this.onDragMove,onend:this.onDragEnd,ignoreFrom:".ev-map-menu-pointer"})},setImageWidth(){const e=this._graphic.getRef(),{naturalWidth:t,naturalHeight:n}=e,{menuImageWidth:i}=this.props,o=0===i?1024:i,s=o/(t/n);this.setState({_graphicWidth:o,_graphicHeight:s})},setContentHeight(){const{windowHeight:e}=this.props.device,{top:t}=i(".ev-container").offset(),n=e-t;this.setState({_contentHeight:n>600?600:n})},getScrollableStyle(){const{_graphicHeight:e,_graphicWidth:t,_x:n,_y:i}=this.state;return{height:e,width:t,transform:`translate(${n}px, ${i}px)`}},onDragMove(e){const{props:t}=this;t.isModalOpen||(t.isDragging||t.onDragStart(),this.setState({_x:this.state._x+e.dx,_y:this.state._y+e.dy}))},onDragEnd(){this.props.onDragEnd()},render(){const{state:e,props:t}=this;return a.createElement("div",{className:r("ev-map-menu-image",{"ev-modal-open":t.isModalOpen}),style:{height:e._contentHeight,maxWidth:t.menuScrollableContainerMaxWidth}},a.createElement("div",{ref:e=>this._scrollable=e},a.createElement("div",{className:"ev-map-menu-image-container",style:this.getScrollableStyle()},a.createElement(m,{ref:e=>this._graphic=e,graphicSrc:t.graphic,onLoad:this.setImageWidth,altText:t.alt}),this.props.children,a.createElement("div",{className:"ev-map-menu-image-overlay"}))))}});e.exports=u},84746:(e,t,n)=>{const i=n(58335),o=n(13980),s=n(2784),{Spring:a,config:r,animated:l}=n(64325),m=n(40145),u=n(50085),c=n(10817),p=i({displayName:"MapMenuInformation",propTypes:{body:o.string,closeButtonText:o.string.isRequired,onInfoCloseClick:o.func.isRequired},onInfoCloseClick(e){e.currentTarget.blur(),e.preventDefault(),this.props.onInfoCloseClick()},render(){const{props:e}=this;return s.createElement(m,null,s.createElement(a,{native:!0,from:{opacity:0},to:{opacity:1},config:r.default},(({opacity:t})=>s.createElement(l.div,{className:"ev-map-menu-information",style:{opacity:t}},s.createElement("button",{className:"ev-button ev-map-menu-button ev-map-menu-information-close-button",onClick:this.onInfoCloseClick,"aria-label":e.closeButtonText},s.createElement(u,{icon:"cross"})),s.createElement("div",{className:"ev-map-menu-information-inner"},s.createElement(c,{className:"ev-map-menu-body",html:e.body,tabIndex:"1"}),s.createElement("div",{className:"ev-map-menu-information-close-button-container"},s.createElement("button",{className:"ev-map-menu-information-close-button-mobile ev-button",onClick:this.onInfoCloseClick},e.closeButtonText)))))))}});e.exports=p},76434:(e,t,n)=>{const i=n(58335),{bool:o,func:s,number:a,object:r,string:l}=n(13980),m=n(2784),{Spring:u,config:c,animated:p}=n(64325),{MenuItemProgress:d,MenuItemHOC:h,MenuItemLink:g}=n(20077),v=n(40145),I=n(19017),M=n(11533),f=n(11865),_=n(57992),b=n(50085),y=n(10817),C=n(86587),E=i({displayName:"MapMenuItem",propTypes:{item:r.isRequired,closeButtonText:l.isRequired,onCloseMenuItemClick:s.isRequired,durationIcon:l,shouldShowProgressBarsOnMenus:o,pageMenuItemsCount:a,pageMenuItemsCompletedCount:a,completedChildrenAsPercentage:a},onCloseMenuItemClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onCloseMenuItemClick()},renderTitle(){const e=I(this.props.item);if(e)return m.createElement(M,{id:`${this.props.item._id}-title`,headingElement:`h${this.context}`,displayTitle:e,className:"ev-map-menu-item-title ev-menu-item-title",innerClassName:"ev-map-menu-item-title-inner ev-menu-item-title-inner"})},renderBody(){if(this.props.item.description)return m.createElement(f,{id:`${this.props.item._id}-description`,body:this.props.item.description,className:"ev-map-menu-item-body ev-menu-item-body",innerClassName:"ev-map-menu-item-body-inner ev-menu-item-body-inner"})},renderDurationIcon(){const{durationIcon:e}=this.props;if(e)return m.createElement(b,{icon:e,className:"ev-menu-item-duration-icon"})},renderElements(e){const{props:t}=this;return _("menuItem",e,{item:t.item})},render(){const{item:e,closeButtonText:t,pageMenuItemsCompletedCount:n,pageMenuItemsCount:i,completedChildrenAsPercentage:o,shouldShowProgressBarsOnMenus:s}=this.props;return m.createElement(v,null,m.createElement(u,{native:!0,from:{opacity:0},to:{opacity:1},config:c.default},(({opacity:a})=>m.createElement(p.div,{className:"ev-map-menu-item ev-menu-item ev-collection-item",style:{opacity:a}},m.createElement("button",{className:"ev-button ev-map-menu-button ev-map-menu-items-close-button",onClick:this.onCloseMenuItemClick,"aria-label":t},m.createElement(b,{icon:"cross"})),m.createElement("div",{className:"ev-map-menu-item-inner ev-clearfix"},m.createElement("div",{className:"ev-map-menu-item-content-container ev-collection-item-content-inner"},this.renderTitle(),this.renderBody(),m.createElement("div",{className:"ev-map-menu-item-duration ev-menu-item-duration"},m.createElement("div",{className:"ev-map-menu-item-duration-inner ev-menu-item-duration-inner"},this.renderDurationIcon(),m.createElement("span",{className:"ev-menu-item-duration-label"},e.durationLabel),m.createElement(y,{element:"span",html:e.duration}))),this.renderElements("content"),s&&m.createElement(d,{item:e,pageMenuItemsCompletedCount:n,pageMenuItemsCount:i,completedChildrenAsPercentage:o})),m.createElement("div",{className:"ev-map-menu-item-buttons ev-collection-item-footer"},m.createElement("div",{className:"ev-collection-item-footer-inner"},m.createElement(g,{id:e._id,isLocked:e._isLocked,isVisited:e._isVisited,linkText:e.linkText,linkIcon:e.linkIcon,isLinkIconRightPosition:e.isLinkIconRightPosition,link:`/${e._type}/${e._id}`}),m.createElement("button",{className:"ev-map-menu-item-close-button-mobile ev-button",onClick:this.onCloseMenuItemClick},t))))))))}});E.contextType=C,e.exports=h(E)},10052:(e,t,n)=>{const i=n(72579),o=n(58335),s=n(13980),a=n(2784),{Motion:r,spring:l}=n(96001),m=n(72779),{connect:u}=n(57903),c=n(88078),p=o({displayName:"MapMenuPointer",propTypes:{item:s.object.isRequired,defaultPointerImage:s.object,defaultPointerWidth:s.number,onClick:s.func.isRequired,isModalOpen:s.bool.isRequired},getInitialState:()=>({_isHovering:!1}),onMouseEnter(){const{isModalOpen:e}=this.props;e||this.setState({_isHovering:!0})},onMouseLeave(){this.setState({_isHovering:!1})},onClick(e){const{props:t}=this;e.preventDefault(),t.isModalOpen||t.onClick(t.item)},getPointerImage(){var e;const{props:t}=this;return(null===(e=t.item._mapMenu)||void 0===e?void 0:e._pointerImage)||t.defaultPointerImage},getPointerImageStyle(){const{props:e}=this,t={},n=e.item._mapMenu._pointerWidth||e.defaultPointerWidth;return n&&(t.width=`${n}px`,t.maxWidth="none"),t},getStyle({scale:e,opacity:t}){const{props:n}=this,o=i(n.item,"_mapMenu._position",{_top:50,_left:50});return{top:`${o._top}%`,left:`${o._left}%`,transform:`translate(-50%, -50%) scale(${e})`,opacity:t}},getMotionStyle(){const{state:e,props:t}=this,n=t.isModalOpen?.5:1,i=e._isHovering?1.2:1;return{scale:l(i,{stiffness:175,damping:e._isHovering?12:20}),opacity:l(n)}},render(){const{props:e}=this;return a.createElement(r,{defaultStyle:{scale:1,opacity:1},style:this.getMotionStyle()},(t=>a.createElement("button",{className:m("ev-map-menu-pointer ev-has-aria-label",{"ev-is-disabled":e.isModalOpen}),style:this.getStyle(t),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick,"aria-label":this.props.item.title},a.createElement(c,{isAriaHidden:!0,graphicSrc:this.getPointerImage(),style:this.getPointerImageStyle()}))))}});e.exports=u(((e,t)=>({item:e.contentObjects[t.itemId]})))(p)},81895:(e,t,n)=>{const i=n(58335),o=n(13980),s=n(2784),a=n(72779),r=n(11533),l=n(50085),m=n(86587),u=i({displayName:"MapMenuTitle",propTypes:{title:o.string.isRequired,body:o.string,onInfoClick:o.func.isRequired,isModalOpen:o.bool.isRequired,infoOpenButtonAriaLabel:o.string},onInfoClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onInfoClick()},renderInfoButton(){const{props:e}=this;if(e.body)return s.createElement("button",{className:a("ev-map-menu-button ev-map-menu-information-button",{"ev-disabled":e.isModalOpen,"ev-has-aria-label":!!e.infoOpenButtonAriaLabel}),disabled:e.isModalOpen,onClick:this.onInfoClick,"aria-label":e.infoOpenButtonAriaLabel},s.createElement(l,{icon:"question"}))},render(){return s.createElement(r,{headingElement:`h${this.context}`,displayTitle:this.props.title,className:"ev-map-menu-title",innerClassName:"ev-map-menu-title-inner"},(e=>s.createElement(s.Fragment,null,e,this.renderInfoButton())))}});u.contextType=m,e.exports=u},66098:(e,t,n)=>{const{registerMenu:i}=n(90876);i("mapMenu",n(93976))}}]);