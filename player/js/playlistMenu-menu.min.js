"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6895],{19017:e=>{e.exports=function(e){var t;const r=e.displayTitle,s=null!==(t=e._heroImage)&&void 0!==t&&t._isEnabled?e._heroImage.title:null;return r||s}},36118:(e,t)=>{t.GROUP_CATEGORY_CHANGED="GROUP_CATEGORY_CHANGED",t.CATEGORY_CHANGED="CATEGORY_CHANGED",t.RESET_CATEGORIES="RESET_CATEGORIES",t.groupCategoryChanged=(e,r)=>({type:t.GROUP_CATEGORY_CHANGED,payload:{groupId:e,categoryId:r}}),t.categoryChanged=e=>({type:t.CATEGORY_CHANGED,payload:{categoryId:e}}),t.resetCategories=()=>({type:t.RESET_CATEGORIES})},1263:(e,t,r)=>{const s=r(58335),n=r(13980),i=r(2784),o=r(72779),a=s({displayName:"PlaylistCategoryButton",propTypes:{category:n.object.isRequired,onClick:n.func.isRequired,isSelected:n.bool},onClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onClick(this.props.category._id)},render(){return i.createElement("button",{className:o("ev-category-button ev-button ev-primary",{"ev-is-selected":this.props.isSelected}),onClick:this.onClick},this.props.category.name)}});e.exports=a},94336:(e,t,r)=>{const s=r(16760),n=r(58335),i=r(13980),o=r(2784),a=n({displayName:"PlaylistGroupSelect",propTypes:{allText:i.string.isRequired,group:i.shape({_id:i.string.isRequired,name:i.string.isRequired,categories:i.object.isRequired,selectedCategory:i.string}).isRequired,onChange:i.func.isRequired},render(){const{allText:e,group:t,onChange:r}=this.props;return o.createElement("div",{className:"ev-playlist-group-select"},o.createElement("label",null,t.name,o.createElement("select",{id:t._id,value:t.selectedCategory,onChange:({target:e})=>r(t._id,e.value)},o.createElement("option",{value:"all"},e),s(t.categories,(({_id:e,name:t})=>o.createElement("option",{value:e,key:e},t))))))}});e.exports=a},79810:(e,t,r)=>{const s=r(58215),n=r(36402),i=r(90882),o=r(13888),a=r(829),l=r(16760),u=r(72579),c=r(58335),d=r(13980),p=r(2784),{connect:m}=r(57903),h=r(72779),{setAriaLive:g}=r(28543),y=r(57992),v=r(14755),C=r(65319),_=r(13457),E=r(46844),b=r(86587),{categoryChanged:I,groupCategoryChanged:R,resetCategories:M}=r(36118),T=r(34207),N=r(94336),S=r(70420),A=r(1263),f=r(98973),k="all",P=c({displayName:"PlaylistMenu",propTypes:{course:d.object.isRequired,menu:d.object.isRequired,device:d.object.isRequired,theme:d.object.isRequired,items:d.object.isRequired,location:d.object.isRequired,categories:d.object.isRequired,groups:d.object.isRequired,selectedCategory:d.string.isRequired,categoryChanged:d.func.isRequired,groupCategoryChanged:d.func.isRequired,resetCategories:d.func.isRequired,setAriaLive:d.func.isRequired,hasActionBar:d.bool.isRequired,isShowingHiddenContent:d.bool,history:d.object.isRequired,classList:d.array},getInitialState:()=>({_selectedItemId:null}),componentDidMount(){this.announceMenuAriaLabel()},componentDidUpdate({menu:e}){e._id!==this.props.menu._id&&this.announceMenuAriaLabel()},announceMenuAriaLabel(){this.props.menu.ariaLabel&&this.props.setAriaLive({message:this.props.menu.ariaLabel,delay:200})},getSelectedCategoriesMap(){const{props:e}=this,t=s(e.groups,((e,t)=>(t.selectedCategory!==k&&(e[t.selectedCategory]=!0),e)),{});return e.selectedCategory!==k&&(t[e.selectedCategory]=!0),t},getMenuItems(){const{props:e}=this,t=this.getSelectedCategoriesMap(),r=e.menu._id!==e.course._id?e.menu._id:null,s=n(t),l=i(e.items,(i=>!(i._isHidden&&!e.isShowingHiddenContent||"page"!==i._type||r&&i._parentId!==r||s&&n(o(t,i._categories))!==s)));return a(l,"_contentObjectOrder")},getAvailableMenus(){return i(this.props.items,(e=>"menu"===e._type))},getClassName(){const{classList:e,theme:t}=this.props;return h("ev-playlist-menu ev-menu",e,{"ev-use-menu-header-styles":t._menu._settings._useMenuHeaderStyles,"ev-disable-inner-flex":t._footer._settings._isStickyFooterDisabled})},getIsMenuReady(){const{menu:e,location:t}=this.props;return!(!e._isReady||!t.isLocationReady)},onResetCategories(e){e.preventDefault(),e.currentTarget.blur();const{props:t}=this;t.resetCategories(),t.history.replace(`/menu/${t.course._id}`)},onCategoryChanged(e){this.props.categoryChanged(e)},onGroupCategoryChanged(e,t){this.props.groupCategoryChanged(e,t)},onMenuChanged(e){const{props:t}=this,r=e===k?t.course._id:e;t.history.push(`/menu/${r}`)},onShowItemContent(e){this.setState({_selectedItemId:e})},renderGroupFilters(){return n(this.props.groups)?l(this.props.groups,(e=>p.createElement(N,{key:e._id,group:e,allText:u(this.props.course,"_playlistMenu.allText","All"),onChange:this.onGroupCategoryChanged}))):null},renderMenuSelect(e){if(!e.length)return;const{props:t}=this;return p.createElement(S,{items:e,value:t.menu._id===t.course._id?k:t.menu._id,allText:u(this.props.course,"_playlistMenu.allText","All"),onChange:this.onMenuChanged})},renderFullPlaylistButton(e){if(!e)return;const{props:t}=this;return p.createElement("button",{onClick:this.onResetCategories,className:"ev-category-button ev-button ev-primary"},u(t.course,"_playlistMenu._fullPlaylist"))},renderFilters(){const e=this.renderGroupFilters(),t=this.getAvailableMenus(),r=this.renderMenuSelect(t);if(!e&&!r)return;const s=this.renderFullPlaylistButton(!n(this.props.categories)&&(e||r));return p.createElement("div",{className:"ev-categories-action-bar-items"},e,r,s)},renderCategoryButtons(){return n(this.props.categories)?p.createElement("div",{className:"ev-categories-action-bar-items"},l(this.props.categories,(e=>p.createElement(A,{key:e._id,category:e,isSelected:this.props.selectedCategory===e._id,onClick:this.onCategoryChanged}))),this.renderFullPlaylistButton(!0)):null},renderActionBar(){const e=this.renderFilters(),t=this.renderCategoryButtons();if(e||t)return p.createElement("div",{className:"ev-categories-action-bar ev-action-bar"},p.createElement("div",{className:"ev-action-bar-inner"},e,t))},getShouldShowProgressBars(){const{props:e}=this,t=u(e.theme,"_menu._settings._shouldShowProgressBarsOnMenus","content"),r=u(e.menu,"_playlistMenu._shouldShowProgressBarsOnMenus",!0);return"content"===t?r:"true"===t},renderItems(){const{props:e,state:t}=this,r=this.getMenuItems(),s=u(e.theme,"_menu._settings._durationIcon",null);return l(r,(r=>p.createElement(f,{key:r._id,itemId:r._id,device:e.device,durationIcon:s,shouldShowProgressBarsOnMenus:this.getShouldShowProgressBars(),isContentVisible:t._selectedItemId===r._id,onShowItemContent:this.onShowItemContent})))},renderElements(e){return y("menu",e,{menu:this.props.menu})},renderHeroImage(e){const{_heroImage:t}=this.props.menu._playlistMenu;if(t)return p.createElement(b.Provider,{value:this.props.menu.displayTitle?this.context+1:this.context},p.createElement(E,{title:t.title,body:t.body,graphic:t._graphic,_contentWidth:t._contentWidth,layout:t.layout,floatingGraphic:t._floatingGraphic,parentSelector:".ev-menu-container-inner",contentObjectType:"menu",theme:this.props.theme,isReady:e}))},render(){var e;const{props:t}=this,r=C(),s=this.getIsMenuReady(),n=t.menu.displayTitle||null!==(e=t.menu._playlistMenu._heroImage)&&void 0!==e&&e.title?this.context+1:this.context;return p.createElement("div",{className:this.getClassName()},p.createElement(_,{backgroundImage:t.menu._playlistMenu._desktopBackgroundImage,mobileBackgroundImage:t.menu._playlistMenu._mobileBackgroundImage}),v(t.menu),p.createElement("main",{className:"ev-menu-container",style:{minHeight:`calc(100vh - ${r})`},tabIndex:"-1"},p.createElement("div",{className:"ev-menu-root"},this.renderElements("root")),p.createElement("div",{className:"ev-menu-container-inner"},this.renderHeroImage(s),p.createElement(T,{menu:t.menu,hasActionBar:this.props.hasActionBar}),p.createElement(b.Provider,{value:n},p.createElement("div",{className:"ev-action-bar-container"},this.renderElements("actionBar")),this.renderActionBar(),p.createElement("div",{className:"ev-menu-items"},p.createElement("div",{className:"ev-menu-items-inner ev-clearfix"},this.renderItems())))),p.createElement("div",{className:"ev-menu-footer"},this.renderElements("footer"))))}});P.contextType=b,e.exports=m((e=>({...e.playlistMenu,items:e.contentObjects})),{setAriaLive:g,categoryChanged:I,groupCategoryChanged:R,resetCategories:M})(P)},34207:(e,t,r)=>{const s=r(58335),n=r(13980),i=r(2784),o=r(36151),a=r(96075),l=r(72954),u=r(72779),c=r(11865),d=r(11533),p=r(86587),m=s({displayName:"PlaylistMenuHeader",propTypes:{menu:n.object.isRequired,hasActionBar:n.bool.isRequired},renderTitle(){if(this.props.menu.displayTitle)return i.createElement(d,{headingElement:`h${this.context}`,displayTitle:this.props.menu.displayTitle,displayTitleSettings:this.props.menu._displayTitleSettings,className:"ev-menu-title ev-header-title",innerClassName:"ev-menu-title-inner ev-header-title-inner"})},renderBody(){if(this.props.menu.body)return i.createElement(c,{className:"ev-menu-body ev-header-body",innerClassName:"ev-menu-body-inner ev-header-body-inner",body:this.props.menu.body})},getStyle(e){const t=e._playlistMenu._backgroundImage;if(!a(t))return l(!0);const{src:r,srcAdvanced:s}=t;return{backgroundImage:`url("${o(r,s,!0)}")`,minHeight:"350px"}},render(){const{menu:e}=this.props;return e.displayTitle||e.body?i.createElement("div",{className:u("ev-menu-header ev-header",{"ev-header-with-action-bar":this.props.hasActionBar}),style:this.getStyle(e)},i.createElement("div",{className:"ev-menu-header-inner ev-header-inner ev-clearfix ev-no-graphic"},i.createElement("div",{className:"ev-menu-header-content ev-header-left"},this.renderTitle(),this.renderBody()))):null}});m.contextType=p,e.exports=m},98973:(e,t,r)=>{const s=r(58335),{bool:n,number:i,object:o,string:a}=r(13980),l=r(2784),u=r(28316),c=r(72779),d=r(19017),p=r(14755),m=r(57992),h=r(11533),g=r(11865),{MenuItemProgress:y,MenuItemHOC:v,MenuItemDuration:C,MenuItemLink:_}=r(20077),E=r(36151),b=r(96075),I=r(26558),R=r(86587),M=s({displayName:"PlaylistMenuItem",propTypes:{item:o.isRequired,device:o.isRequired,durationIcon:a,shouldShowProgressBarsOnMenus:n,isContentVisible:n.isRequired,isVisibleItem:n,pageMenuItemsCount:i,pageMenuItemsCompletedCount:i,completedChildrenAsPercentage:i},getInitialState:()=>({_height:window.innerHeight}),componentDidMount(){this.updateSizes()},UNSAFE_componentWillReceiveProps({device:e}){e!==this.props.device&&this.updateSizes()},updateSizes(){const e=u.findDOMNode(this).offsetWidth;this.setState({_height:e})},onClick(e){const{item:t}=this.props;t._isLocked&&e.preventDefault()},renderTitle(){const e=d(this.props.item);if(e)return l.createElement(h,{id:`${this.props.item._id}-title`,headingElement:`h${this.context}`,displayTitle:e,className:"ev-menu-item-title",innerClassName:"ev-menu-item-title-inner"})},renderBody(){if(this.props.item.description)return l.createElement(g,{id:`${this.props.item._id}-description`,body:this.props.item.description,className:"ev-menu-item-body",innerClassName:"ev-menu-item-body-inner"})},renderDuration(){const{duration:e,durationLabel:t}=this.props.item;if(e)return l.createElement(C,{duration:e,durationIcon:this.props.durationIcon,durationLabel:t})},renderProgress(){const{props:e}=this;if(null!=e&&e.shouldShowProgressBarsOnMenus)return l.createElement(y,{item:e.item,pageMenuItemsCompletedCount:e.pageMenuItemsCompletedCount,pageMenuItemsCount:e.pageMenuItemsCount,completedChildrenAsPercentage:e.completedChildrenAsPercentage})},renderLink(){const{item:e}=this.props;return l.createElement(_,{id:e._id,isLocked:e._isLocked,isVisited:e._isVisited,linkText:e.linkText,linkIcon:e.linkIcon,isLinkIconRightPosition:e.isLinkIconRightPosition,link:`/${e._type}/${e._id}`})},getStyle(){var e,t;const r={height:`${this.state._height}px`},s=null===(e=this.props.item)||void 0===e||null===(t=e._playlistMenu)||void 0===t?void 0:t._graphic;return b(s)?(r.backgroundImage=`url("${E(s.src,s.srcAdvanced,!0)}")`,r):r},getItemClass(){return c("ev-menu-item ev-collection-item",`ev-menu-item-${this.props.item._id}`,{"ev-is-visible-item":this.props.isVisibleItem,"ev-is-content-visible":this.props.isContentVisible})},renderElements(e){return m("menuItem",e,{item:this.props.item})},render(){return l.createElement(I,{id:this.props.item._id,name:"menu item",className:this.getItemClass(),style:this.getStyle()},this.renderElements("root"),p(this.props.item,"menuitem"),l.createElement("div",{className:"ev-menu-item-inner ev-collection-item-inner"},l.createElement("div",{className:"ev-collection-item-content"},l.createElement("div",{className:"ev-collection-item-content-inner ev-clearfix"},this.renderTitle(),l.createElement("div",{className:"ev-menu-item-hidden-content"},this.renderBody(),this.renderDuration(),this.renderElements("content"),this.renderProgress(),this.renderLink())))))}});M.contextType=R,e.exports=v(M)},70420:(e,t,r)=>{const s=r(16760),n=r(58335),i=r(13980),o=r(2784),a=n({displayName:"PlaylistMenuSelect",propTypes:{label:i.string,allText:i.string.isRequired,items:i.array.isRequired,onChange:i.func.isRequired,value:i.string.isRequired},getDefaultProps:()=>({label:"Topic"}),render(){return o.createElement("div",{className:"ev-playlist-group-select"},o.createElement("label",null,this.props.label,o.createElement("select",{value:this.props.value,onChange:({target:e})=>this.props.onChange(e.value),id:"ev-playlist-menu-select"},o.createElement("option",{value:"all",key:"all"},this.props.allText),s(this.props.items,(e=>{const t=e._playlistMenu?e._playlistMenu._menuDropdownTitle:null;return o.createElement("option",{key:e._id,value:e._id},t||e.title)})))))}});e.exports=a},54961:(e,t,r)=>{const{registerMenu:s,registerReducer:n}=r(90876),i=r(16572),o=r(79810);n("playlistMenu",i),s("playlistMenu",o,{shouldFilterChildren:!1,shouldRerenderOnMenuChanged:!1})},16572:(e,t,r)=>{const s=r(34519),n=r(87622),i=r(92191),o=r(13888),a=r(17620),{SETUP_APP:l}=r(63444),{CATEGORY_CHANGED:u,GROUP_CATEGORY_CHANGED:c,RESET_CATEGORIES:d}=r(36118),p={selectedCategory:"all",categories:{},groups:{}};e.exports=(e=p,t)=>{switch(t.type){case l:return function(e,{course:t,settings:r}){if("playlistMenu"!==r._menu)return e;const s=n(t._categories,"_id"),l=i(t._categoryGroups).map((e=>({...e,categories:o(s,e._categories),selectedCategory:"all"}))).keyBy("_id").value(),u=i(t._categoryGroups).map((e=>e._categories)).flatten().value(),c=a(s,u);return{...p,groups:l,categories:c}}(e,t.payload);case u:return{...e,selectedCategory:t.payload.categoryId};case c:return{...e,groups:{...e.groups,[t.payload.groupId]:{...e.groups[t.payload.groupId],selectedCategory:t.payload.categoryId}}};case d:return{...e,selectedCategory:"all",groups:s(e.groups,(e=>({...e,selectedCategory:"all"})))};default:return e}}}}]);