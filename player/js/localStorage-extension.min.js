"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6347],{4707:(e,o)=>{o.BOOKMARKING_COMPONENT_COMPLETED="BOOKMARKING_COMPONENT_COMPLETED",o.BOOKMARKING_NAVIGATE_TO_COMPONENT="BOOKMARKING_NAVIGATE_TO_COMPONENT",o.BOOKMARKING_CANCEL_CONTINUE="BOOKMARKING_CANCEL_CONTINUE",o.bookmarkingComponentCompleted=e=>({type:o.BOOKMARKING_COMPONENT_COMPLETED,payload:e})},64595:(e,o)=>{o.LOCALSTORAGE_LOAD_SESSION="LOCALSTORAGE_LOAD_SESSION",o.LOCALSTORAGE_SAVE_SESSION="LOCALSTORAGE_SAVE_SESSION",o.LOCALSTORAGE_CLEAR_SESSION="LOCALSTORAGE_CLEAR_SESSION",o.LOCALSTORAGE_SESSION_CHANGE="LOCALSTORAGE_SESSION_CHANGE",o.localStorageLoadSession=()=>({type:o.LOCALSTORAGE_LOAD_SESSION}),o.localStorageSaveSession=e=>({type:o.LOCALSTORAGE_SAVE_SESSION,payload:e}),o.localStorageClearSession=()=>({type:o.LOCALSTORAGE_CLEAR_SESSION}),o.localStorageSessionChange=e=>({type:o.LOCALSTORAGE_SESSION_CHANGE,payload:e})},82465:(e,o,a)=>{const t=a(92191),l=a(55281),{Observable:S}=a(28761),{DATA_READY:r,REFETCH_COURSE_DATA:n,setAppReadyState:c,resetCourse:s}=a(63444),{COMPONENT_COMPLETED:i,COMPONENT_TRACKABLE_CHANGE:E}=a(29933),{LOGIC_STATE_CHANGE:O}=a(66376),{getTracking:p,setTracking:_,restoreComponentAttributes:A}=a(84491),{BOOKMARKING_CANCEL_CONTINUE:g}=a(4707),{COURSE_ASSESSMENT_COMPONENTS_RESET:C}=a(36580),{LOCALSTORAGE_LOAD_SESSION:L,LOCALSTORAGE_SAVE_SESSION:N,LOCALSTORAGE_CLEAR_SESSION:u,localStorageLoadSession:d,localStorageSaveSession:T,localStorageClearSession:R,localStorageSessionChange:y}=a(64595);o.localStorageSetupEpic=(e,o)=>e.filter((e=>{var a;if(e.type!==r)return!1;const{app:t,course:l}=o.getState();return!t.isLivePreview&&(null===(a=l._localStorage)||void 0===a?void 0:a._isEnabled)})).mergeMap((()=>S.concat(S.of(c("localStorage",!1)),S.of(d()),S.of(c("localStorage",!0))))),o.localStorageLoadSessionEpic=(e,o)=>e.ofType(L).mergeMap((()=>{const{course:e,scorm:a,components:r}=o.getState(),n=null==a?void 0:a._isEnabled;let c;try{c=localStorage.getItem(e._id)}catch(e){return console.warn("Localstorage not available for saving learning componentData",e),S.empty()}if(c){if(c=JSON.parse(c),c.useAdvancedTracking)return _(c,!0),S.of(y(c));const e=function(e,o,a){return t(e).keys().map((t=>{const S=e[t],r=l(o.components,{_id:t});return a&&S._isComplete||!a?{...S,...r}:S})).keyBy("_id").value()}(r,c,n);return A(e),S.of(y(c))}return S.empty()})).catch((e=>(console.warn("LocalStorage load error",e),S.of({type:"LOCALSTORAGE_ERROR",payload:e})))),o.localStorageSaveSessionEpic=(e,o)=>e.ofType(N).map((e=>{const a=function(e,o){const{course:a}=e;return p((e=>{const t={...e,useAdvancedTracking:!0,lastCompletedComponentId:o||""};try{localStorage.setItem(a._id,JSON.stringify(t))}catch(e){console.warn("Localstorage not available for saving learning componentData",e)}return t}))}(o.getState(),e.payload);return y(a)})).catch((e=>S.of({type:"LOCALSTORAGE_ERROR",payload:e}))),o.localStorageClearSessionEpic=(e,o)=>e.ofType(u).map((()=>{const{course:e}=o.getState();return function(e){try{null!==localStorage.getItem(e)&&localStorage.removeItem(e)}catch(e){console.warn("Localstorage not available for saving learning data",e)}}(e._id),y({})})).catch((e=>S.of({type:"LOCALSTORAGE_ERROR",payload:e}))),o.localStorageHandleResetsEpic=(e,o)=>e.filter((e=>{var a;if(![C,n].includes(e.type))return!1;const{app:t,course:l}=o.getState();return!t.isLivePreview&&(null===(a=l._localStorage)||void 0===a?void 0:a._isEnabled)})).map((()=>R())),o.localStorageComponentCompleteEpic=(e,o)=>e.filter((e=>{if(![i,E].includes(e.type))return!1;const{app:a,_localStorage:t}=o.getState();return!a.isLivePreview&&(null==t?void 0:t._isEnabled)})).map((e=>T(e.payload.componentId))),o.localStorageLogicStateChangeEpic=(e,o)=>e.filter((e=>{if(e.type!==O)return!1;const{app:a,_localStorage:t}=o.getState();return!a.isLivePreview&&(null==t?void 0:t._isEnabled)})).map((()=>T())),o.localStorageBookmarkingCancelEpic=(e,o)=>e.filter((e=>{if(e.type!==g)return!1;const{app:a,scorm:t,_localStorage:l}=o.getState();return(null==t||!t._isEnabled)&&!a.isLivePreview&&(null==l?void 0:l._isEnabled)&&(null==l?void 0:l._shouldResetUsingBookMarking)})).map((()=>s()))},48794:(e,o,a)=>{const{registerReducer:t,registerEpics:l}=a(90876),S=a(66047),{localStorageSetupEpic:r,localStorageLoadSessionEpic:n,localStorageSaveSessionEpic:c,localStorageClearSessionEpic:s,localStorageComponentCompleteEpic:i,localStorageBookmarkingCancelEpic:E,localStorageHandleResetsEpic:O,localStorageLogicStateChangeEpic:p}=a(82465);t("_localStorage",S),l(r,n,c,s,i,E,O,p)},66047:(e,o,a)=>{const{SETUP_DATA:t}=a(63444),l={_isEnabled:!1,session:{}},{LOCALSTORAGE_SESSION_CHANGE:S}=a(64595);e.exports=(e=l,o)=>{if(o.type===t){const{_localStorage:a}=o.payload.course;return null!=a&&a._isEnabled?{...e,...a}:l}return e._isEnabled?o.type===S?{...e,session:o.payload}:e:l}}}]);