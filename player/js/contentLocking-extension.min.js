"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2765],{5486:(e,t)=>{t.ACHIEVEMENTS_COMPONENT_COMPLETED="ACHIEVEMENTS_COMPONENT_COMPLETED",t.ACHIEVEMENTS_RESET_COURSE="ACHIEVEMENTS_RESET_COURSE",t.achievementsComponentCompleted=e=>({type:t.ACHIEVEMENTS_COMPONENT_COMPLETED,payload:e})},17781:(e,t)=>{t.SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE="SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE",t.SET_CONTENT_LOCKING_AS_READY="SET_CONTENT_LOCKING_AS_READY",t.setContentLockingInitialState=()=>({type:t.SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE}),t.setContentLockingAsReady=()=>({type:t.SET_CONTENT_LOCKING_AS_READY})},20051:(e,t,n)=>{const c=n(58335),{bool:o,object:i}=n(13980),s=n(2784),r=n(72779),a=n(11865),l=n(50085),p=c({displayName:"ArticleLock",propTypes:{article:i.isRequired,isEnabled:o.isRequired},getLockIcon(){const{_lockIcon:e}=this.props.article._contentLocking;return"key hole"===e?"key-hole":"trophy"===e?"trophy2":e},render(){if(!this.props.isEnabled)return null;const{_contentLocking:e,_isLocked:t}=this.props.article,n=(null==e?void 0:e._lockedApperance)||"default",{lockIconAriaLabel:c,_lockedText:o}=e;return s.createElement("div",{className:r("ev-article-lock",{"ev-locked":t})},s.createElement("div",{className:r(`ev-article-lock-overlay ev-article-lock-appearance-${n}`)},s.createElement("div",{className:"ev-article-lock-overlay-panel"}),s.createElement("div",{className:"ev-article-lock-strip"},s.createElement("div",{className:"ev-article-lock-circle"},s.createElement(l,{className:"ev-article-lock-icon",ariaLabel:c,icon:this.getLockIcon()}))),o?s.createElement(a,{className:"ev-article-lock-text",body:o}):null))}});e.exports=p},7164:(e,t,n)=>{const{bool:c,object:o}=n(13980),i=n(2784),{connect:s}=n(57903),r=n(20051),a=e=>i.createElement(r,e);a.propTypes={article:o.isRequired,isEnabled:c.isRequired},e.exports=s((({course:e},{article:t})=>{var n,c;return{isEnabled:(null===(n=e._contentLocking)||void 0===n?void 0:n._isEnabled)&&(null===(c=t._contentLocking)||void 0===c?void 0:c._isEnabled)}}))(a)},40559:(e,t,n)=>{const{registerEpics:c,registerReducer:o}=n(90876),i=n(54096),{registerContentLockingElementsEpic:s,mapAppReadyToSetupContentLockingEpic:r,setContentLockedItemsInitialStateEpic:a,checkItemsUnlockedOnContentObjectCompletedEpic:l,checkItemsUnlockedOnArticleCompletedEpic:p,checkItemsUnlockedOnComponentCompletedEpic:_,checkItemsUnlockedOnAchievementsGained:d}=n(87524);c(s,r,a,_,p,l,d),o("contentLocking",i)},87524:(e,t,n)=>{const c=n(87622),o=n(92191),{Observable:i}=n(28761),{COMPONENT_COMPLETED:s}=n(29933),{APP_READY:r,SETUP_APP:a}=n(63444),{updateContentObjects:l,CONTENT_OBJECT_COMPLETED:p}=n(68767),{updateArticles:_,ARTICLE_COMPLETED:d}=n(88072),{addElement:E}=n(51777),{addClassName:k,removeClassName:m}=n(84070),{ACHIEVEMENTS_COMPONENT_COMPLETED:T}=n(5486),{SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE:u,setContentLockingInitialState:g}=n(17781),L=n(23077),C=n(53031),O=n(68350),N=n(71493),y=n(16389),S=n(10564),I=n(7164);t.registerContentLockingElementsEpic=(e,t)=>e.filter(L(a,t)).map((()=>E({parent:"article",name:"articleLock",component:I,position:"top"}))),t.mapAppReadyToSetupContentLockingEpic=(e,t)=>e.filter((({type:e})=>{var n;if(e!==r)return!1;const{app:{isPagePreview:c},course:o}=t.getState();return!c&&(null===(n=o._contentLocking)||void 0===n?void 0:n._isEnabled)})).mapTo(g()),t.setContentLockedItemsInitialStateEpic=(e,t)=>e.ofType(u).mergeMap((()=>{const e=t.getState(),n=[...N(e.articles,e),...O(e.articles,e),...C(e.articles,e),...y(e.articles,e)],s=[...N(e.contentObjects,e),...O(e.contentObjects,e),...C(e.contentObjects,e),...y(e.contentObjects,e)],r=c(n,"_id"),a=c(s,"_id"),p=o(n).filter((e=>"blur"===e._contentLocking._lockedApperance)).map((e=>(e._isLocked?k:m)({_id:e._id,className:"ev-is-blurred"}))).value();return i.of(_(r),l(a),...p)})),t.checkItemsUnlockedOnComponentCompletedEpic=(e,t)=>e.filter(L(s,t)).mergeMap((()=>{const e=t.getState();return i.of(...N(e.articles,e),...N(e.contentObjects,e))})).mergeMap((e=>S(e,t.getState()))),t.checkItemsUnlockedOnArticleCompletedEpic=(e,t)=>e.filter(L(d,t)).mergeMap((()=>{const e=t.getState();return i.of(...O(e.articles,e),...O(e.contentObjects,e))})).mergeMap((e=>S(e,t.getState()))),t.checkItemsUnlockedOnContentObjectCompletedEpic=(e,t)=>e.filter(L(p,t)).mergeMap((()=>{const e=t.getState();return i.of(...C(e.articles,e),...C(e.contentObjects,e))})).mergeMap((e=>S(e,t.getState()))),t.checkItemsUnlockedOnAchievementsGained=(e,t)=>e.filter(L(T,t)).mergeMap((()=>{const e=t.getState();return i.of(...y(e.articles,e),...y(e.contentObjects,e))})).mergeMap((e=>S(e,t.getState())))},10564:(e,t,n)=>{const{Observable:c}=n(28761),{updateContentObject:o}=n(68767),{updateArticle:i}=n(88072),{addPrompt:s}=n(90672),{addClassName:r,removeClassName:a}=n(84070);e.exports=(e,t)=>{if(!t.app.isAppReady)return c.empty();const n=[];if("article"===e._type){if(n.push(i(e)),"blur"===e._contentLocking._lockedApperance){const t=e._isLocked?r:a;n.push(t({_id:e._id,className:"ev-is-blurred"}))}}else n.push(o(e));return e._isLocked||e._contentLocking._shouldDisableNotifyOnUnlock||n.push(s({title:e.displayTitle,body:t.course._contentLocking.unlockedNotifyMessage,_glyph:{_type:"icon",_icon:"unlock"}})),c.of(...n)}},23077:(e,t,n)=>{const c=n(72579);e.exports=(e,t)=>n=>{const{app:{isPagePreview:o},course:i}=t.getState();return n.type===e&&!o&&c(i,"_contentLocking._isEnabled",!1)}},16389:(e,t,n)=>{const c=n(13888),o=n(72579),i=n(58215);function s(e,t){return a(e=c(e,t.contentLocking["points gained"]),o(t,"achievements._points._currentPoints",0))}function r(e,t){return a(e=c(e,t.contentLocking["stars gained"]),o(t,"achievements._stars._currentStarsCollected",0))}function a(e,t){return i(e,((e,n)=>{const c=n._contentLocking._requiredAmount>t;return c!==n._isLocked&&e.push({_id:n._id,_isLocked:c,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e}),[])}e.exports=(e,t)=>[...s(e,t),...r(e,t)]},68350:(e,t,n)=>{const c=n(13888),o=n(58215),i=n(90882),s=n(55281),r=n(22337),a=n(57471);e.exports=(e,t)=>(e=c(e,t.contentLocking.article),o(e,((e,n)=>{let c=a(n._contentLocking._requiredCompleteIds,t);c=i(c,(e=>"article"===e._type));const o=!!s(c,(e=>!r(e,t)));return o!==n._isLocked&&e.push({_id:n._id,_isLocked:o,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e}),[]))},71493:(e,t,n)=>{const c=n(13888),o=n(58215),i=n(90882),s=n(55281),r=n(57471);e.exports=(e,t)=>(e=c(e,t.contentLocking.component),o(e,((e,n)=>{const c="correct components"===n._contentLocking._lockingType;let o=r(n._contentLocking._requiredCompleteIds,t);o=i(o,(e=>c?"component"===e._type&&e._isQuestionType:"component"===e._type));const a=!!s(o,(e=>c?!e._isComplete||!e._isCorrect:!e._isComplete));return a!==n._isLocked&&e.push({_id:n._id,_isLocked:a,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e}),[]))},53031:(e,t,n)=>{const c=n(13888),o=n(58215),i=n(90882),s=n(55281),r=n(22337),a=n(57471);e.exports=(e,t)=>(e=c(e,t.contentLocking.contentObject),o(e,((e,n)=>{let c=a(n._contentLocking._requiredCompleteIds,t);c=i(c,(e=>"page"===e._type||"menu"));const o=!!s(c,(e=>!r(e,t)));return o!==n._isLocked&&e.push({_id:n._id,_isLocked:o,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e}),[]))},54096:(e,t,n)=>{const c=n(34519),o=n(98346),i=n(79421),s=n(72579),{SETUP_APP:r}=n(63444),a={article:[],component:[],contentObject:[],"stars gained":[],"points gained":[]};e.exports=(e=a,t)=>{if(t.type===r){const{course:n,contentObjects:r,articles:l}=t.payload;if(n._contentLocking&&n._contentLocking._isEnabled){const t=c(e,(()=>[])),a=[...o(l),...o(r)];return i(a,(e=>{if(!e._contentLocking||!e._contentLocking._isEnabled)return;let c=e._contentLocking._lockingType,o=!0;"correct components"===c&&(c="component"),("stars gained"!==c||s(n,"_achievements._stars._isEnabled"))&&("points gained"!==c||s(n,"_achievements._points._isEnabled"))||(o=!1),o&&t[c].push(e._id)})),t}return a}return e}}}]);